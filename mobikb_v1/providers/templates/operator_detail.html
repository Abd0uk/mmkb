{% extends 'base.html' %} {% block content %}

<h1 class="text-center my-4">
  Operator Details <strong>({{ operator.operator_name }})</strong>
</h1>

<!-- Operator Info Section -->
<div class="container-fluid">
  <div class="row g-0">
    <!-- Removed spacing between cards -->
    <div class="col-md-1">
      <div class="card text-dark bg-light p-2 h-100">
        <h6 class="card-title"><strong>Provider</strong></h6>
        <p class="card-text">{{ operator.provider_name }}</p>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card text-dark bg-light p-2 h-100">
        <h6 class="card-title"><strong>APN</strong></h6>
        <p class="card-text">{{ operator.apn }}</p>
      </div>
    </div>
    <div class="col-md-1">
      <div class="card text-dark bg-light p-2 h-100">
        <h6 class="card-title"><strong>ICCID</strong></h6>
        <p class="card-text">{{ operator.iccid }}</p>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card text-dark bg-light p-2 h-100">
        <h6 class="card-title"><strong>Check Usage</strong></h6>
        <p class="card-text">{{ operator.check_usage }}</p>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card text-dark bg-light p-2 h-100">
        <h6 class="card-title"><strong>eSIM Status</strong></h6>
        <p class="card-text">{{ operator.esim_status }}</p>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card text-dark bg-light p-2 h-100">
        <h6 class="card-title"><strong>Internet Breakout (IP)</strong></h6>
        <p class="card-text">{{ operator.esim_status }}</p>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card text-dark bg-light p-2 h-100">
        <h6 class="card-title"><strong>Top-Up Eligibility</strong></h6>
        {% if operator.topup_eligibility|slice:":4" == "http" %}
        <a
          href="{{ operator.topup_eligibility }}"
          target="_blank"
          class="btn btn-secondary btn-sm text-white"
          >Press Here</a
        >

        {% else %}
        <span>Not available</span>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<br />

<!-- Policy/Process Section -->
<div class="container-fluid">
  <div class="row g-0">
    <div class="col-md-3">
      <div class="card p-3 bg-light text-dark h-100">
        <h6 class="card-title"><strong>Activation Process</strong></h6>
        <p class="card-text">{{ operator.activation }}</p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 bg-light text-dark h-100">
        <h6 class="card-title"><strong>Replacement Process</strong></h6>
        <p class="card-text">{{ operator.replacement }}</p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 bg-light text-dark h-100">
        <h6 class="card-title"><strong>Cancellation Process</strong></h6>
        <p class="card-text">{{ operator.cancellation }}</p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 bg-light text-dark h-100">
        <h6 class="card-title"><strong>Package Change Flexibility</strong></h6>
        <p class="card-text">{{ operator.pkg_change }}</p>
      </div>
    </div>
  </div>
</div>

<!-- Country Selection and Data Display Section -->
<div class="container my-4">
  <div class="row">
    <!-- Country Selection (Sticky Sidebar) -->
    <div class="col-md-4">
      <div class="sticky-top">
        <div class="card bg-secondary text-white">
          <div class="card-body p-3">
            <h5>Select a Country</h5>
            <select id="countrySelect" class="form-select">
              <option value="">Select a country</option>

              {% for country in country_data %}
              <option value="{{ country.country }}">
                {{ country.country.name }}
              </option>
              {% endfor %}
            </select>
            <br />
            <ul>
              <li>Networks & Country Restrictions</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Country Data Display -->
    <div class="col-md-8">
      <div class="card bg-light p-3" id="countryDetails" style="display: none">
        <h5>Country Details</h5>
        <div id="detailsContent"></div>
      </div>
    </div>
  </div>
</div>

<!-- Updates (From Whatsapp) -->
<button type="button" class="btn btn-primary">
  Updates <span class="badge text-bg-secondary">3</span>
</button>

<!-- accordion -->
<div class="accordion accordion-flush bg-dark" id="accordionFlushExample">
  <div class="accordion-item">
    <h2 class="accordion-header">
      <button
        class="accordion-button collapsed"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#flush-collapseOne"
        aria-expanded="false"
        aria-controls="flush-collapseOne"
      >
        we can offer replacments for the new packages purchased on september
      </button>
    </h2>
    <div
      id="flush-collapseOne"
      class="accordion-collapse collapse"
      data-bs-parent="#accordionFlushExample"
    >
      <div class="accordion-body">
        Placeholder content for this accordion, which is intended to demonstrate
        the <code>.accordion-flush</code> class. This is the first item's
        accordion body.
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header">
      <button
        class="accordion-button collapsed"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#flush-collapseTwo"
        aria-expanded="false"
        aria-controls="flush-collapseTwo"
      >
        Accordion Item #2
      </button>
    </h2>
    <div
      id="flush-collapseTwo"
      class="accordion-collapse collapse"
      data-bs-parent="#accordionFlushExample"
    >
      <div class="accordion-body">
        Placeholder content for this accordion, which is intended to demonstrate
        the <code>.accordion-flush</code> class. This is the second item's
        accordion body. Let's imagine this being filled with some actual
        content.
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header">
      <button
        class="accordion-button collapsed"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#flush-collapseThree"
        aria-expanded="false"
        aria-controls="flush-collapseThree"
      >
        Accordion Item #3
      </button>
    </h2>
    <div
      id="flush-collapseThree"
      class="accordion-collapse collapse"
      data-bs-parent="#accordionFlushExample"
    >
      <div class="accordion-body">
        Placeholder content for this accordion, which is intended to demonstrate
        the <code>.accordion-flush</code> class. This is the third item's
        accordion body. Nothing more exciting happening here in terms of
        content, but just filling up the space to make it look, at least at
        first glance, a bit more representative of how this would look in a
        real-world application.
      </div>
    </div>
  </div>
</div>

<!-- Country Data Fetching Script -->
<script>
  document
    .getElementById("countrySelect")
    .addEventListener("change", function () {
      const countryCode = this.value;
      const operatorId = "{{ operator.id }}";

      if (countryCode) {
        fetch(`/get-country-data/${operatorId}/${countryCode}/`)
          .then((response) => response.json())
          .then((data) => {
            if (data) {
              let networkBadges = "";
              data.networks.forEach((network) => {
                networkBadges += `<span class="badge bg-info text-dark me-1">${network}</span>`;
              });

              document.getElementById("detailsContent").innerHTML = `
              <h6>Networks:</h6>
              <p>${networkBadges}</p>
              <p><strong>Country Restrictions & KYC:</strong> <span class="badge bg-danger text-dark me-1">${data.kyc_policy}</span>
</p>
            `;
              document.getElementById("countryDetails").style.display = "block";
            }
          });
      } else {
        document.getElementById("countryDetails").style.display = "none";
      }
    });
</script>
{% endblock content %}
